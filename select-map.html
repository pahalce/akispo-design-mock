<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AkiSpot - 地図から探す</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  
  <!-- デザイントークン -->
  <link rel="stylesheet" href="design-tokens.css">
  <script src="tailwind-config.js"></script>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900 font-sans antialiased flex flex-col h-screen overflow-hidden">
  <!-- Header -->
  <header class="bg-white shadow-sm h-header flex items-center px-4 gap-4 flex-shrink-0 relative z-20">
    <a href="home.html" class="flex items-center justify-center w-icon-button h-icon-button rounded-full hover:bg-gray-100 transition-colors">
      <span class="material-symbols-outlined text-secondary">arrow_back</span>
    </a>
    <h1 class="text-lg font-bold text-secondary flex-1">地図から探す</h1>
    <button id="current-location-btn" class="flex items-center justify-center w-icon-button h-icon-button rounded-full hover:bg-gray-100 transition-colors">
      <span class="material-symbols-outlined text-secondary">my_location</span>
    </button>
  </header>

  <!-- Map Container -->
  <div class="flex-1 relative">
    <!-- Map Mockup -->
    <div id="map" class="relative w-full h-full bg-gradient-to-br from-green-200 to-green-300 overflow-hidden cursor-crosshair">
      <!-- Road lines for map feel -->
      <div class="absolute bg-white shadow-md" style="width: 4px; height: 100%; left: 30%; top: 0;"></div>
      <div class="absolute bg-white shadow-md" style="width: 4px; height: 100%; left: 70%; top: 0;"></div>
      <div class="absolute bg-white shadow-md" style="width: 100%; height: 4px; left: 0; top: 35%;"></div>
      <div class="absolute bg-white shadow-md" style="width: 100%; height: 4px; left: 0; top: 65%;"></div>
      
      <!-- Building/Location indicators (decorative) -->
      <div class="absolute top-[20%] left-[25%] w-6 h-6 bg-gray-400 rounded opacity-30"></div>
      <div class="absolute top-[40%] left-[60%] w-8 h-8 bg-gray-400 rounded opacity-30"></div>
      <div class="absolute top-[70%] left-[35%] w-7 h-7 bg-gray-400 rounded opacity-30"></div>
      <div class="absolute top-[55%] left-[75%] w-5 h-5 bg-gray-400 rounded opacity-30"></div>
      <div class="absolute top-[25%] left-[80%] w-6 h-6 bg-gray-400 rounded opacity-30"></div>
      
      <!-- User Pin (will be positioned on click) -->
      <div id="user-pin" class="absolute hidden flex-col items-center" style="transform: translate(-50%, -100%);">
        <!-- Ripple effect -->
        <div class="absolute w-12 h-12 bg-primary rounded-full opacity-30 animate-ripple" style="top: 32px; left: 50%; transform: translate(-50%, -50%);"></div>
        <!-- Pin icon -->
        <div class="relative">
          <span class="material-symbols-outlined filled text-6xl text-primary drop-shadow-lg">location_on</span>
        </div>
      </div>
    </div>

    <!-- Zoom Controls -->
    <div class="absolute right-4 top-1/2 transform -translate-y-1/2 flex flex-col gap-2 z-10">
      <button class="w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-50 transition-colors">
        <span class="material-symbols-outlined icon-lg text-secondary">add</span>
      </button>
      <button class="w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-50 transition-colors">
        <span class="material-symbols-outlined icon-lg text-secondary">remove</span>
      </button>
    </div>

    <!-- Instructions (show before pin is placed) -->
    <div id="instructions" class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-white rounded-full px-6 py-3 shadow-lg z-10">
      <div class="flex items-center gap-2">
        <span class="material-symbols-outlined icon-sm text-primary">touch_app</span>
        <span class="text-sm font-medium text-secondary">地図をタップしてエリアを選択</span>
      </div>
    </div>

    <!-- Location Info Card (show after pin is placed) -->
    <div id="location-info" class="absolute top-4 left-4 right-4 bg-white rounded-2xl p-4 shadow-xl z-10 hidden">
      <div class="flex items-start gap-3">
        <div class="w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center flex-shrink-0">
          <span class="material-symbols-outlined text-primary">location_on</span>
        </div>
        <div class="flex-1">
          <h3 class="text-base font-bold text-secondary mb-1">選択したエリア</h3>
          <p class="text-sm text-gray-600" id="location-name">渋谷駅周辺</p>
        </div>
        <button id="clear-pin" class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-gray-100 transition-colors">
          <span class="material-symbols-outlined icon-sm text-gray-400">close</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Action Button -->
  <div class="bg-white shadow-lg p-4 relative z-20">
    <button id="search-area-btn" class="w-full bg-primary text-white font-bold text-lg py-4 rounded-xl shadow-lg hover:bg-primary/90 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
      <div class="flex items-center justify-center gap-2">
        <span class="material-symbols-outlined icon-xl">search</span>
        <span>このエリアで探す</span>
      </div>
    </button>
  </div>

  <script>
    const map = document.getElementById('map');
    const userPin = document.getElementById('user-pin');
    const instructions = document.getElementById('instructions');
    const locationInfo = document.getElementById('location-info');
    const searchBtn = document.getElementById('search-area-btn');
    const clearBtn = document.getElementById('clear-pin');
    const currentLocationBtn = document.getElementById('current-location-btn');
    
    let pinPlaced = false;

    // マップクリックでピンを配置
    map.addEventListener('click', (e) => {
      const rect = map.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      // ピンの位置を設定
      userPin.style.left = x + 'px';
      userPin.style.top = y + 'px';
      userPin.classList.remove('hidden');
      
      // バウンスアニメーション
      userPin.classList.remove('animate-pin-bounce');
      void userPin.offsetWidth; // リフロー
      userPin.classList.add('animate-pin-bounce');
      
      // UI更新
      if (!pinPlaced) {
        instructions.classList.add('hidden');
        locationInfo.classList.remove('hidden');
        searchBtn.disabled = false;
        pinPlaced = true;
      }
      
      // エリア名をランダムに変更（モックアップ用）
      const areas = ['渋谷駅周辺', '表参道エリア', '代々木公園周辺', '恵比寿駅周辺', '六本木エリア'];
      document.getElementById('location-name').textContent = areas[Math.floor(Math.random() * areas.length)];
    });

    // ピンをクリア
    clearBtn.addEventListener('click', () => {
      userPin.classList.add('hidden');
      locationInfo.classList.add('hidden');
      instructions.classList.remove('hidden');
      searchBtn.disabled = true;
      pinPlaced = false;
    });

    // 現在地ボタン（モックアップなので画面中央にピンを配置）
    currentLocationBtn.addEventListener('click', () => {
      const rect = map.getBoundingClientRect();
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      
      userPin.style.left = centerX + 'px';
      userPin.style.top = centerY + 'px';
      userPin.classList.remove('hidden');
      
      // バウンスアニメーション
      userPin.classList.remove('animate-pin-bounce');
      void userPin.offsetWidth;
      userPin.classList.add('animate-pin-bounce');
      
      // UI更新
      instructions.classList.add('hidden');
      locationInfo.classList.remove('hidden');
      searchBtn.disabled = false;
      pinPlaced = true;
      
      document.getElementById('location-name').textContent = '現在地周辺';
    });

    // エリアで探すボタン
    searchBtn.addEventListener('click', () => {
      // モックアップなのでhome.htmlに戻る
      window.location.href = 'home.html';
    });
  </script>
</body>
</html>

